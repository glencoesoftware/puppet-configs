#!/bin/bash

confdir=$(puppet config print confdir 2>/dev/null)
manifest=$(puppet config print manifest 2>/dev/null)

# update repo
${confdir}/repo-mx $1

# apply catalog
if [ -e "${manifest}" ]; then
  if [ -t ]; then
    puppet apply $manifest
  else
    puppet apply --logdest syslog $manifest
  fi
fi
